<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../theme.css" />
</head>

<body id="popup">
    <div id="pcontent">
        <h3 id="ptitle"></h3>

        <footer id="paction" hidden>
            <p>
                <small>
                    <input type="checkbox" id="track"> Track my usage
                </small>
            </p>
        </footer>

        <canvas id="pchart"></canvas>
    </div>

    <div id="error-content" class="hidden">
        <p>An error has occured. See console.</p>
    </div>

    <script src="../lib/moment-with-locales.min.js"></script>
    <script src="../lib/chart.js"></script>
    <script>
        (function() {
        var randomData = [];

        for (var i = 0; i < 7; i++) {
            var now = new Date();
            now.setHours(0);
            now.setMinutes(0);
            now.setSeconds(0);
            now.setMilliseconds(0);
            randomData.push({
                x: now.setDate(now.getDate() - i),
                y: Math.ceil(Math.random() * 100)
            })
        }

        var dmin = new Date();
        dmin.setHours(0);
        dmin.setMinutes(0);
        dmin.setSeconds(0);
        dmin.setMilliseconds(0);
        dmin.setDate(dmin.getDate() - 7);

        var dmax = new Date();
        dmax.setHours(0);
        dmax.setMinutes(0);
        dmax.setSeconds(0);
        dmax.setMilliseconds(0);
        dmax.setDate(dmax.getDate() + 1);

        var xdata = [];
        var ydata = [];

        randomData.forEach(element => {
            xdata.push(element.x);
            ydata.push(element.y);
        });
        
        
        var ctx = document.getElementById('pchart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'bar',
            data: {
                "labels": xdata,
                "datasets": [{
                    "label": "ydata1",
                    "data": ydata,
                    "borderWidth": 0,
                    "backgroundColor": function (context) {
                        var index = context.dataIndex;
                        var value = context.dataset.data[index];
                        var min = Math.min(...context.dataset.data);
                        var max = Math.max(...context.dataset.data);
                        var opacity = value / max + 0.1;
                        var color = "rgba(65, 131, 196, " + opacity.toString() + ")";
                        return color;
                    },
                }]
            },
            options: {
                legend: {
                    display: false
                },
                tooltips: {
                    callbacks: {
                        label: function (tooltipItem) {
                            return tooltipItem.yLabel + " minutes";
                        }
                    }
                },
                scales: {
                    xAxes: [{
                        offset: true,
                        type: 'time',
                        time: {
                            displayFormats: {
                                day: 'ddd',
                                hour: 'HH'
                            },
                            unit: 'day',
                            tooltipFormat: 'dddd'
                        },
                        gridLines: {
                            display: false,
                            drawBorder: false
                        }
                    }],
                    yAxes: [{
                        ticks: {
                            min: 0
                        },
                        gridLines: {
                            display: false
                        }
                    }]
                }
            }
        });
    })();

    </script>

</body>

</html>